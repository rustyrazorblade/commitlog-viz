/*
 * This file was generated by the Gradle 'init' task.
 *
 * This generated file contains a sample Kotlin application project to get you started.
 */

buildscript {
    repositories {
        jcenter()
    }

    dependencies {
        classpath 'com.netflix.nebula:gradle-ospackage-plugin:7.6.3'
    }
}

plugins {
    // Apply the Kotlin JVM plugin to add support for Kotlin.
    id 'org.jetbrains.kotlin.jvm' version '1.3.41'

    // Apply the application plugin to add support for building a CLI application.
    id 'application'
    id "nebula.ospackage" version "7.6.3"
}

ext {
    version = "0.1"

}

allprojects {
    repositories {
        // Use jcenter for resolving dependencies.
        // You can declare any Maven/Ivy/file repository here.
        jcenter()
    }
}

ospackage {
    packageName = 'commitlog-viz'
    arch = "all"
    os = LINUX
    packager "Jon Haddad"
    maintainer "Jon Haddad"
    vendor "Jon Haddad"
    license "Apache License 2.0"
    description "Commit log visualization tool for Apache Cassandra"
}

configurations {
    cassandra311
    cassandra40
}


dependencies {
    // Align versions of all Kotlin components
    implementation platform('org.jetbrains.kotlin:kotlin-bom')

    implementation project(":core")

    // Use the Kotlin JDK 8 standard library.
    implementation 'org.jetbrains.kotlin:kotlin-stdlib-jdk8'
    implementation 'io.dropwizard:dropwizard-core:2.0.0-rc11'

    cassandra311 project(":cassandra311")

    // Use the Kotlin test library.
    testImplementation 'org.jetbrains.kotlin:kotlin-test'

    // Use the Kotlin JUnit integration.
    testImplementation 'org.jetbrains.kotlin:kotlin-test-junit'
}

application {
    // Define the main class for the application
    mainClassName = 'com.rustyrazorblade.commmitlog_gui.AppKt'
}

run {
    args = ['server', 'src/test/resources/test.yml']
}


def run311 = tasks.register("run311", JavaExec) {
    main = application.mainClassName
    classpath = sourceSets.main.runtimeClasspath + configurations.cassandra311
    args = ['server', 'src/test/resources/test.yml']
}

def packageCassandra3 = tasks.register("packageCassandra3", Deb) {
    from(configurations.cassandra311)
}

